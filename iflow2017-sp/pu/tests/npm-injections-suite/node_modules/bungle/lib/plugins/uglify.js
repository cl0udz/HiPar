import compiler from 'uglify-js';
import { ModPipe } from '../pipe';


export default class ExtPipe extends ModPipe {
    constructor() {
        super(...arguments);

        this.defaultConfig({
            pattern: '**/*.js'
        });
    }

    static schema() {
        return {
            description: 'Uglify Javascript code'
        };
    }

    async generate(file) {
        const source = await file.source.content();
        this.log('verbose', `Uglifying ${file.name}`);
        return compiler.minify(source, { fromString: true }).code;
    }
}
