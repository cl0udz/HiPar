"use strict";

var _require = require('tap'),
    test = _require.test;

var Fastify = require('..');

test('Should accept a custom genReqId function', function (t) {
  t.plan(4);
  var fastify = Fastify({
    genReqId: function genReqId() {
      return 'a';
    }
  });
  fastify.get('/', function (req, reply) {
    t.ok(req.raw.id);
    reply.send({
      id: req.raw.id
    });
  });
  fastify.listen(0, function (err) {
    t.error(err);
    fastify.inject({
      method: 'GET',
      url: 'http://localhost:' + fastify.server.address().port
    }, function (err, res) {
      t.error(err);
      var payload = JSON.parse(res.payload);
      t.equal(payload.id, 'a');
      fastify.close();
    });
  });
});