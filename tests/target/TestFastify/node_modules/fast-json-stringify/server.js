'use strict';

var http = require('http');

var stringify = require('.')({
  type: 'object',
  properties: {
    hello: {
      type: 'string'
    },
    data: {
      type: 'number'
    },
    nested: {
      type: 'object',
      properties: {
        more: {
          type: 'string'
        }
      }
    }
  }
});

var server = http.createServer(handle);

function handle(req, res) {
  var data = {
    hello: 'world',
    data: 42,
    nested: {
      more: 'data'
    }
  };

  if (req.url === '/JSON') {
    res.end(JSON.stringify(data));
  } else {
    res.end(stringify(data));
  }
}

server.listen(3000);