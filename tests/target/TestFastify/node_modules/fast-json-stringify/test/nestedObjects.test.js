'use strict';

var test = require('tap').test;

var build = require('..');

test('nested objects with same properties', function (t) {
  t.plan(1);
  var schema = {
    title: 'nested objects with same properties',
    type: 'object',
    properties: {
      stringProperty: {
        type: 'string'
      },
      objectProperty: {
        type: 'object',
        additionalProperties: true
      }
    }
  };
  var stringify = build(schema);

  try {
    var value = stringify({
      stringProperty: 'string1',
      objectProperty: {
        stringProperty: 'string2',
        numberProperty: 42
      }
    });
    t.is(value, '{"stringProperty":"string1","objectProperty":{"stringProperty":"string2","numberProperty":42}}');
  } catch (e) {
    t.fail();
  }
});