'use strict';

require("core-js/modules/es.object.to-string");

require("core-js/modules/es.promise");

require("core-js/modules/es.object.to-string");

require("core-js/modules/es.promise");

var t = require('tap');

var boot = require('..');

var app = {};
boot(app);
t.plan(5);
app.use(function (f, opts) {
  return Promise.reject(new Error('kaboom'));
}).after(function (err, cb) {
  t.pass('this is just called');
  cb(err);
}).after(function () {
  t.pass('this is just called');
}).after(function (err, cb) {
  t.pass('this is just called');
  cb(err);
});
app.ready().then(function () {
  t.fail('this should not be called');
})["catch"](function (err) {
  t.ok(err);
  t.strictEqual(err.message, 'kaboom');
});