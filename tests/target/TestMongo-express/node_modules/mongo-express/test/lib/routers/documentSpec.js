'use strict';

require("core-js/modules/es.array.iterator");

require("core-js/modules/es.object.to-string");

require("core-js/modules/es.promise");

require("core-js/modules/es.regexp.constructor");

require("core-js/modules/es.regexp.exec");

require("core-js/modules/es.regexp.to-string");

require("core-js/modules/es.string.iterator");

require("core-js/modules/es.string.match");

require("core-js/modules/web.dom-collections.iterator");

require("core-js/modules/es.array.iterator");

require("core-js/modules/es.object.to-string");

require("core-js/modules/es.promise");

require("core-js/modules/es.regexp.constructor");

require("core-js/modules/es.regexp.exec");

require("core-js/modules/es.regexp.to-string");

require("core-js/modules/es.string.iterator");

require("core-js/modules/es.string.match");

require("core-js/modules/web.dom-collections.iterator");

var expect = require('chai').expect;

var httpUtils = require('../../testHttpUtils');

var mongoUtils = require('../../testMongoUtils');

var asPromise = require('../../testUtils').asPromise;

var dbName = mongoUtils.testDbName; // const collectionName = mongoUtils.testCollectionName;

var urlColName = mongoUtils.testURLCollectionName;
describe('Router document', function () {
  var request;
  var close;
  var db;
  before(function () {
    return mongoUtils.initializeDb().then(function (newDb) {
      db = newDb;
      return httpUtils.createServer();
    }).then(function (server) {
      request = server.request;
      close = server.close;
    });
  });
  it('GET /db/<dbName>/<collection>/<document> should return html', function () {
    var docId = mongoUtils.getFirstDocumentId();
    return asPromise(function (cb) {
      return request.get(httpUtils.getDocumentUrl(dbName, urlColName, docId)).expect(200).end(cb);
    }).then(function (res) {
      expect(res.text).to.match(new RegExp("<title>".concat(docId, " - Mongo Express</title>")));
    });
  });
  it('POST /db/<dbName>/<collection> should add a new document');
  it('DEL /db/<dbName>/<collection>/<document> should delete the document');
  it('PUT /db/<dbName>/<collection>/<document> should update the document');
  after(function () {
    return Promise.all([mongoUtils.cleanAndCloseDb(db), close()]);
  });
});