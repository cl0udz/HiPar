'use strict';

require("core-js/modules/es.array.concat");

require("core-js/modules/es.array.iterator");

require("core-js/modules/es.object.to-string");

require("core-js/modules/es.promise");

require("core-js/modules/es.regexp.constructor");

require("core-js/modules/es.regexp.exec");

require("core-js/modules/es.regexp.to-string");

require("core-js/modules/es.string.iterator");

require("core-js/modules/es.string.match");

require("core-js/modules/web.dom-collections.iterator");

require("core-js/modules/es.array.concat");

require("core-js/modules/es.array.iterator");

require("core-js/modules/es.object.to-string");

require("core-js/modules/es.promise");

require("core-js/modules/es.regexp.constructor");

require("core-js/modules/es.regexp.exec");

require("core-js/modules/es.regexp.to-string");

require("core-js/modules/es.string.iterator");

require("core-js/modules/es.string.match");

require("core-js/modules/web.dom-collections.iterator");

var expect = require('chai').expect;

var httpUtils = require('../../testHttpUtils');

var mongoUtils = require('../../testMongoUtils');

var asPromise = require('../../testUtils').asPromise;

var dbName = mongoUtils.testDbName;
var collectionName = mongoUtils.testCollectionName;
var urlColName = mongoUtils.testURLCollectionName;
describe('Router collection', function () {
  var request;
  var close;
  var db;
  before(function () {
    return mongoUtils.initializeDb().then(function (newDb) {
      db = newDb;
      return httpUtils.createServer();
    }).then(function (server) {
      request = server.request;
      close = server.close;
    });
  });
  it('GET /db/<dbName>/<collection> should return html', function () {
    return asPromise(function (cb) {
      return request.get("/db/".concat(dbName, "/").concat(urlColName)).expect(200).end(cb);
    }).then(function (res) {
      expect(res.text).to.match(new RegExp("<title>".concat(collectionName, " - Mongo Express</title>")));
      expect(res.text).to.match(new RegExp("<h1 id=\"pageTitle\">Viewing Collection: ".concat(collectionName, "</h1>")));
    });
  });
  it('POST /db/<dbName> should add a new collection');
  it('DEL /db/<dbName>/<collection> should delete the collection');
  it('PUT /db/<dbName>/<collection> should rename the collection');
  it('GET /db/<dbName>/compact/<collection> should compact');
  it('GET /db/<dbName>/expArr/<collection> should export as array');
  it('GET /db/<dbName>/expCsv/<collection> should export as csv');
  it('GET /db/<dbName>/reIndex/<collection> should reIndex');
  it('PUT /db/<dbName>/addIndex/<collection> should addIndex');
  it('GET /db/<dbName>/export/<collection> should export as json');
  it('GET /db/<dbName>/dropIndex/<collection> should drop index');
  it('GET /db/<dbName>/updateCollections/<collection> should updateCollections');
  after(function () {
    return Promise.all([mongoUtils.cleanAndCloseDb(db), close()]);
  });
});